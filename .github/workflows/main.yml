name: Test GCP JSON

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Step 1 - Write and Show JSON
        run: |
          echo "📝 Writing DUMMY_JSON to service_account.json..."
          echo "$DUMMY_JSON" > service_account.json
          echo "📂 Content of service_account.json:"
          cat service_account.json

      - name: Step 2 - Validate JSON
        run: |
          echo "🔍 Checking JSON structure..."
          python3 - <<'PY'
          import json
          try:
              with open("service_account.json") as f:
                  data = json.load(f)
              print("✅ JSON loaded successfully")
              print("client_email:", data.get("client_email"))
              print("project_id:", data.get("project_id"))
          except Exception as e:
              print("❌ JSON Error:", e)
              exit(1)
          PY
