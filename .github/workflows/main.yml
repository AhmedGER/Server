name: Test Service Account JSON

on:
  workflow_dispatch:

jobs:
  validate-json:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Show repo files
        run: |
          echo "📂 Listing repo files..."
          ls -R

      - name: Validate service_account.json
        run: |
          echo "🔍 Checking JSON structure..."
          python3 - <<'PY'
          import json
          try:
              with open("service_account.json") as f:
                  data = json.load(f)
              print("✅ JSON loaded successfully")
              print("client_email:", data.get("client_email"))
              print("project_id:", data.get("project_id"))
          except Exception as e:
              print("❌ JSON Error:", e)
              exit(1)
          PY
